\documentclass{assignment}
\title{5370 Midterm}

\begin{document}

\textbf{3.}
\label{SquishyBear}
The average word in English is $\lambda =5.1$ letters.
\begin{enumerate}
\item  If letters are drawn randomly from an $N=27$ character alphabet (A through Z and a space),\footnote{
    We are not considering punctuation, capitalization or numbers.
  }
  then when is a thick novel with $W$ words typical? Explain your reasoning. \\

  \textbf{Solution:} \\
  When
  \begin{align}
    p\left(X^{\ceil{W*(5.1 + 1)}}\right) & \approx 2^{-W*(5.1 + 1)*(5.1 + 1)} \label{problem3_1}
  \end{align}
  Because when n is very large, $E\left[\df{1}{n}l(X^n)\right] \approx H(X)$, which means $H(X) \approx \lambda$. The number of alphabets
  here, including space, should be about $\ceil{W * (\lambda + 1)}$, where ``+1'' is due the space character. Since
  we are adding space at the end of each words, the entropy for words with space should be $\lambda + 1$. So we have
  (\ref{problem3_1}), satisfying which makes the sequence at least weakly typical.

\item Here is a web page of 40,000 sampled words
  \begin{center}
    \verb"http://www.math.cornell.edu/~mec/2003-2004/cryptography/subs/frequencies.html"
  \end{center}
  \begin{enumerate}
  \item Complete the {\bf Count} column in table by including the {\em space}. Call the resulting empirical
    distribution $q(x)$ where $x=0,1,2,\cdots$ corresponds to (space, e, t, a, o, $\cdots$). \\
    \textbf{Solution:} \\
    Space should be 40,000, above E, i.e. the first entry on the table.
    The distribution shown in the page is very close to Poisson distribution.

  \item Find the value of $\alpha$ that minimizes the Kullback-Liebler distance between the distribution corresponding
    to this augmented table and
    \begin{align}
      p(x) = (1-\alpha) \alpha^x \label{eq:p3b_p(x)}
    \end{align}
    $$ $$ \\
    \textbf{Solutions:}\\
    \begin{align*}
      q(x) & = \df{\lambda^x}{x!}e^{-\lambda} = \df{\lambda^x}{x! e^{\lambda}} \\
      p(x) & = (1-\alpha) \alpha^x
    \end{align*}
    \begin{align*}
      D(p||q) & = \sum_x p(x)\log \df{p(x)}{q(x)}\\
              & = \sum_{x=0}^{26} (1-\alpha) \alpha^x \log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda^x} \\
              & = \sum_{x=0}^{26} \left[(1-\alpha) \alpha^x\log \df{x!e^{\lambda}}{\lambda^x}
                + (1-\alpha) \alpha^x\log (1-\alpha) \alpha^x\right]
    \end{align*}
    Since this is a function contains an odd degree of polynomial function, $\left.a^{x+1}\right|_{x=26}$, this function
    has no global minimum or global maximum. So we have to use (\ref{eq:p3b_p(x)}) as our true distribution.

    % \begin{align*}
    %   D(p||q) & = \sum_x p(x)\log \df{p(x)}{q(x)}\\
    %        & = \sum_{x=0}^{26} (1-\alpha) \alpha^x \log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda} \\
    %   \shortintertext{for $x=0$:}
    %   \df{d}{d\alpha}\left((1-\alpha) \log\df{e^{\lambda}(1 - \alpha)}{\lambda}\right)
    %           & = -\log\df{e^{\lambda}(1 - \alpha)}{\lambda}
    %             - \df{e^{\lambda}(1 - \alpha)}{\lambda} \df{\lambda}{e^{\lambda}(1 - \alpha)} \\
    %           & = -\log\df{e^{\lambda}(1 - \alpha)}{\lambda} - 1 \\
    %  \end{align*}
    %  \begin{align*}
    %   \shortintertext{for $x = 1, 2, \dots, 26$, let:}
    %   T & = (1-\alpha) \alpha^x \log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda} \\
    %        & = \alpha^x\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda} -
    %          \alpha^{x+1}\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda} \\
    %   \df{d}{d\alpha} T
    %        & = xa^{x-1}\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda}
    %          + a^x \left( \df{x!e^{\lambda}}{\lambda} \right)
    %          \df{(-a^x + x(1 - \alpha)\alpha^{x-1})\lambda}{x!e^{\lambda}(1-\alpha) \alpha^x} \\
    %        & \quad - (x+1)\alpha^x\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda}
    %          - a^{x+1} \left( \df{x!e^{\lambda}}{\lambda} \right)
    %          \df{(-a^x + x(1 - \alpha)\alpha^{x-1})\lambda}{x!e^{\lambda}(1-\alpha) \alpha^x} \\
    %        & = xa^{x-1}\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda}
    %          + \df{-a^x + x \alpha^{x-1} - x\alpha^x}{(1-\alpha)} \\
    %        & \quad - (x+1)\alpha^x\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda}
    %          - \df{-a^{x+1} + x(1 - \alpha)\alpha^{x}}{1-\alpha} \\
    %        & = (x a^{x-1} - (x+1) \alpha^x)\log \df{x!e^{\lambda}(1-\alpha) \alpha^x}{\lambda}
    %          + \df{-a^x + x \alpha^{x-1} - x\alpha^x + a^{x+1} - x(1 - \alpha)\alpha^{x}}{1-\alpha}
    % \end{align*}

    \begin{align*}
      D(q || p) & = \sum_x q(x) \log \df{q(x)}{p(x)} \numberthis \label{eq:p3b_KLD}\\
                & = \sum_x \df{\lambda}{x!e^{\lambda}}\log \df{\lambda}{x!e^{\lambda} (1-\alpha)\alpha^x} \\
                & = \sum_x \df{\lambda}{x!e^{\lambda}}(\log \lambda - \log (x! e^{\lambda}(1 - \alpha) \alpha^x)) \\
                & = \df{27\lambda}{x!e^{\lambda}} - \sum_{x=0}^{26} \log (x! e^{\lambda}(1 - \alpha) \alpha^x)
    \end{align*}
    Since log is a concave function and this particular one is a inverted log function, if there is a point where
    derivative is 0, it must be a global minimum.
    \begin{align*}
      \df{d}{d\alpha} D(q || p) & = - \sum_{x=0}^{26} \df{x x!e^{\lambda}a^{x-1} - (x+1)!e^{\lambda}a^x}
                                                        {x!e^{\lambda}(1-\alpha)\alpha^x} \\
                                & = - \sum_{x=0}^{26} \df{x a^{-1} - (x+1)}{1-\alpha} \\
                                & = \df{\sum_{x=0}^{26}[x - \alpha(x + 1)]}{\alpha^2 - \alpha} = 0 \\
      \sum_{x=0}^{26}[x - \alpha(x + 1)] & = 0 \\
      \alpha\sum_{x=0}^{26}(x + 1) & = \sum_{x=0}^{26} x \\
      \alpha & = \df{\sum_{x=0}^{26} x}{\sum_{x=0}^{26}(x + 1)} = \df{13}{14}
    \end{align*}
    So, when $\alpha = \frac{13}{14}$, (\ref{eq:p3b_KLD}) has the smallest value.

  \item Compare this to the $\alpha$ that minimizes
    $$ \sum_{x=0}^\infty \left| p(x) -  q(x) \right|^2 $$ \\
    \textbf{Solution:} \\
    Since we only have $0-26$, i.e., 26 alphabets with one space character, the summation would only go up to 26, reset
    of terms would be all 0
    \begin{align*}
      \sum_{x=0}^{26} \left| p(x) -  q(x) \right|^2
      & = \sum_{x=0}^{26} \left| (1- \alpha) \alpha^x - \df{\lambda}{x!e^{\lambda}}\right|^2 \\
      & = \sum_{x=0}^{26} \left| \df{(1-\alpha)\alpha^xx!e^\lambda - \lambda}{x!e^\lambda}\right|^2 \\
      & = \sum_{x=0}^{26} \left| \df{\alpha^xx!e^\lambda - \alpha^{x+1}x!e^\lambda - \lambda}{x!e^\lambda}\right|^2
    \end{align*}


  \item What is the average word length in English based on $q(x)$? On $p(x)$?
  \end{enumerate}
\end{enumerate}


\end{document}
